---
phase: 01-foundation
plan: 06
type: execute
wave: 2
depends_on: ["01-03"]
files_modified:
  - src/components/ChannelCard.tsx
  - src/components/ChannelGrid.tsx
  - src/components/ConfirmDialog.tsx
autonomous: true

must_haves:
  truths:
    - "Channel card shows thumbnail, name, subscriber count"
    - "Grid is responsive (1 col mobile, 2 tablet, 3-4 desktop)"
    - "Delete button triggers confirmation dialog"
    - "Confirm dialog has cancel and delete buttons"
  artifacts:
    - path: "src/components/ChannelCard.tsx"
      provides: "Individual channel display"
      exports: ["ChannelCard"]
      min_lines: 40
    - path: "src/components/ChannelGrid.tsx"
      provides: "Responsive grid container"
      exports: ["ChannelGrid"]
      min_lines: 15
    - path: "src/components/ConfirmDialog.tsx"
      provides: "Confirmation dialog using native dialog"
      exports: ["ConfirmDialog"]
      min_lines: 30
  key_links:
    - from: "src/components/ChannelCard.tsx"
      to: "src/lib/types.ts"
      via: "Channel type import"
      pattern: "import.*Channel.*from"
    - from: "src/components/ConfirmDialog.tsx"
      to: "dialog element"
      via: "native dialog ref"
      pattern: "useRef.*HTMLDialogElement"
---

<objective>
Create the UI components for displaying channels in a responsive grid with delete confirmation.

Purpose: REQ-CH-002 (responsive grid), REQ-CH-003 (channel card with metadata), REQ-CH-004 (delete with confirmation).
Output: Reusable ChannelCard, ChannelGrid, and ConfirmDialog components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-03-SUMMARY.md (if exists)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ConfirmDialog Component</name>
  <files>
    src/components/ConfirmDialog.tsx
  </files>
  <action>
    Create src/components/ConfirmDialog.tsx using native HTML dialog:
    ```typescript
    import { useRef, useImperativeHandle, forwardRef } from 'react'

    export interface ConfirmDialogProps {
      title: string
      message: string
      confirmLabel?: string
      cancelLabel?: string
      confirmVariant?: 'danger' | 'primary'
      onConfirm: () => void
      onCancel?: () => void
    }

    export interface ConfirmDialogRef {
      open: () => void
      close: () => void
    }

    /**
     * Confirmation dialog using native <dialog> element.
     * Handles focus trap, backdrop, and Escape key automatically.
     */
    export const ConfirmDialog = forwardRef<ConfirmDialogRef, ConfirmDialogProps>(
      function ConfirmDialog(
        {
          title,
          message,
          confirmLabel = 'Confirm',
          cancelLabel = 'Cancel',
          confirmVariant = 'danger',
          onConfirm,
          onCancel,
        },
        ref
      ) {
        const dialogRef = useRef<HTMLDialogElement>(null)

        useImperativeHandle(ref, () => ({
          open: () => dialogRef.current?.showModal(),
          close: () => dialogRef.current?.close(),
        }))

        const handleCancel = () => {
          dialogRef.current?.close()
          onCancel?.()
        }

        const handleConfirm = () => {
          dialogRef.current?.close()
          onConfirm()
        }

        const confirmButtonClass =
          confirmVariant === 'danger'
            ? 'bg-red-600 hover:bg-red-500'
            : 'bg-blue-600 hover:bg-blue-500'

        return (
          <dialog
            ref={dialogRef}
            className="bg-[#272727] text-[#f1f1f1] rounded-xl p-0 max-w-md w-full backdrop:bg-black/70"
          >
            <div className="p-6">
              <h2 className="text-lg font-semibold">{title}</h2>
              <p className="mt-2 text-[#aaaaaa]">{message}</p>

              <div className="mt-6 flex gap-3 justify-end">
                <button
                  onClick={handleCancel}
                  className="px-4 py-2 rounded-lg bg-[#3f3f3f] hover:bg-[#4f4f4f] text-white font-medium transition-colors"
                >
                  {cancelLabel}
                </button>
                <button
                  onClick={handleConfirm}
                  className={`px-4 py-2 rounded-lg ${confirmButtonClass} text-white font-medium transition-colors`}
                >
                  {confirmLabel}
                </button>
              </div>
            </div>
          </dialog>
        )
      }
    )
    ```
  </action>
  <verify>
    TypeScript compiles: `npx tsc --noEmit`
    Component exports ConfirmDialog and types
  </verify>
  <done>
    ConfirmDialog component created with native dialog, forwardRef for open/close control
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ChannelCard Component</name>
  <files>
    src/components/ChannelCard.tsx
  </files>
  <action>
    Create src/components/ChannelCard.tsx:
    ```typescript
    import { useRef } from 'react'
    import type { Channel } from '../lib/types'
    import { ConfirmDialog, type ConfirmDialogRef } from './ConfirmDialog'

    interface ChannelCardProps {
      channel: Channel
      onDelete: (id: string) => void
    }

    /**
     * Displays a single channel with thumbnail, name, subscribers, and delete button.
     * REQ-CH-003: thumbnail (88x88), name, subscriber count, added by, created date
     */
    export function ChannelCard({ channel, onDelete }: ChannelCardProps) {
      const dialogRef = useRef<ConfirmDialogRef>(null)

      const handleDeleteClick = () => {
        dialogRef.current?.open()
      }

      const handleConfirmDelete = () => {
        onDelete(channel.id)
      }

      // Format subscriber count (e.g., 1.2M, 500K)
      const formatSubscribers = (count: number | null): string => {
        if (count === null) return 'Hidden'
        if (count >= 1_000_000) return `${(count / 1_000_000).toFixed(1)}M`
        if (count >= 1_000) return `${(count / 1_000).toFixed(0)}K`
        return count.toString()
      }

      // Format date as relative or absolute
      const formatDate = (dateString: string): string => {
        const date = new Date(dateString)
        const now = new Date()
        const diffDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24))

        if (diffDays === 0) return 'Today'
        if (diffDays === 1) return 'Yesterday'
        if (diffDays < 7) return `${diffDays} days ago`
        return date.toLocaleDateString()
      }

      return (
        <>
          <div className="bg-[#272727] rounded-xl p-4 hover:bg-[#3f3f3f] transition-colors group">
            <div className="flex items-start gap-4">
              {/* Thumbnail */}
              <div className="flex-shrink-0">
                {channel.thumbnail_url ? (
                  <img
                    src={channel.thumbnail_url}
                    alt={`${channel.name} thumbnail`}
                    className="w-[88px] h-[88px] rounded-full object-cover"
                  />
                ) : (
                  <div className="w-[88px] h-[88px] rounded-full bg-[#3f3f3f] flex items-center justify-center">
                    <span className="text-2xl text-[#aaaaaa]">
                      {channel.name.charAt(0).toUpperCase()}
                    </span>
                  </div>
                )}
              </div>

              {/* Info */}
              <div className="flex-1 min-w-0">
                <h3 className="font-semibold text-lg truncate" title={channel.name}>
                  {channel.name}
                </h3>

                <p className="text-[#aaaaaa] text-sm mt-1">
                  {formatSubscribers(channel.subscriber_count)} subscribers
                </p>

                <p className="text-[#aaaaaa] text-xs mt-2">
                  Added {formatDate(channel.created_at)}
                  {channel.added_by && ` by ${channel.added_by}`}
                </p>
              </div>

              {/* Delete button */}
              <button
                onClick={handleDeleteClick}
                className="opacity-0 group-hover:opacity-100 p-2 rounded-lg hover:bg-[#4f4f4f] transition-all"
                aria-label={`Delete ${channel.name}`}
              >
                <svg
                  className="w-5 h-5 text-[#aaaaaa] hover:text-red-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    strokeLinecap="round"
                    strokeLinejoin="round"
                    strokeWidth={2}
                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                  />
                </svg>
              </button>
            </div>
          </div>

          <ConfirmDialog
            ref={dialogRef}
            title="Delete Channel"
            message={`Are you sure you want to delete "${channel.name}"? This will also delete all videos and ideas from this channel.`}
            confirmLabel="Delete"
            cancelLabel="Cancel"
            confirmVariant="danger"
            onConfirm={handleConfirmDelete}
          />
        </>
      )
    }
    ```
  </action>
  <verify>
    TypeScript compiles: `npx tsc --noEmit`
    Component exports ChannelCard
  </verify>
  <done>
    ChannelCard component created with thumbnail, metadata, delete button, and confirmation dialog
  </done>
</task>

<task type="auto">
  <name>Task 3: Create ChannelGrid Component</name>
  <files>
    src/components/ChannelGrid.tsx
  </files>
  <action>
    Create src/components/ChannelGrid.tsx:
    ```typescript
    import type { Channel } from '../lib/types'
    import { ChannelCard } from './ChannelCard'

    interface ChannelGridProps {
      channels: Channel[]
      onDeleteChannel: (id: string) => void
    }

    /**
     * Responsive grid for displaying channel cards.
     * REQ-CH-002: 1 col mobile, 2 tablet, 3-4 desktop
     */
    export function ChannelGrid({ channels, onDeleteChannel }: ChannelGridProps) {
      if (channels.length === 0) {
        return (
          <div className="text-center py-12">
            <svg
              className="w-16 h-16 mx-auto text-[#3f3f3f]"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={1.5}
                d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"
              />
            </svg>
            <h3 className="mt-4 text-lg font-medium text-[#f1f1f1]">No channels yet</h3>
            <p className="mt-2 text-[#aaaaaa]">
              Add a YouTube channel URL to start tracking competitors.
            </p>
          </div>
        )
      }

      return (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
          {channels.map((channel) => (
            <ChannelCard
              key={channel.id}
              channel={channel}
              onDelete={onDeleteChannel}
            />
          ))}
        </div>
      )
    }
    ```
  </action>
  <verify>
    TypeScript compiles: `npx tsc --noEmit`
    Component exports ChannelGrid
    Grid uses responsive classes: grid-cols-1, sm:grid-cols-2, lg:grid-cols-3, xl:grid-cols-4
  </verify>
  <done>
    ChannelGrid component created with responsive layout and empty state
  </done>
</task>

</tasks>

<verification>
1. `src/components/ConfirmDialog.tsx` exports ConfirmDialog with forwardRef
2. `src/components/ChannelCard.tsx` exports ChannelCard
3. `src/components/ChannelGrid.tsx` exports ChannelGrid
4. TypeScript compiles without errors
5. Grid classes match requirements (1/2/3/4 columns at breakpoints)
6. ChannelCard shows thumbnail (88x88), name, subscribers, date
7. Delete button triggers ConfirmDialog
</verification>

<success_criteria>
- ChannelCard displays all metadata (REQ-CH-003)
- ChannelGrid is responsive (REQ-CH-002)
- ConfirmDialog uses native dialog element
- Delete button opens confirmation
- Confirm closes dialog and calls onDelete
- Cancel closes dialog without action
- Empty state shown when no channels
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-06-SUMMARY.md`
</output>

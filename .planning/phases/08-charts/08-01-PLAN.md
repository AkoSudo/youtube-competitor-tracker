---
phase: 08-charts
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - src/index.css
  - src/lib/chartUtils.ts
autonomous: true

must_haves:
  truths:
    - "Recharts library is installed and available for import"
    - "Chart-specific CSS variables exist for dark theme colors"
    - "Data transformation functions exist for frequency and scatter data"
  artifacts:
    - path: "package.json"
      provides: "Recharts dependency"
      contains: "recharts"
    - path: "src/index.css"
      provides: "Chart color CSS variables"
      contains: "--color-chart-primary"
    - path: "src/lib/chartUtils.ts"
      provides: "Data transformation helpers"
      exports: ["transformToFrequencyData", "transformToScatterData"]
      min_lines: 40
  key_links:
    - from: "src/lib/chartUtils.ts"
      to: "src/lib/types.ts"
      via: "Video type import"
      pattern: "import.*Video.*from"
---

<objective>
Install Recharts library and create foundation for chart components.

Purpose: Charts require Recharts v3.7.0 (prior decision) and consistent dark theme colors. Data transformation utilities keep chart components focused on rendering.
Output: Recharts installed, CSS variables for chart colors, chartUtils.ts with transformation functions.
</objective>

<execution_context>
@/Users/thihaaung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thihaaung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-charts/08-RESEARCH.md

@src/index.css
@src/lib/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Recharts and add chart CSS variables</name>
  <files>package.json, package-lock.json, src/index.css</files>
  <action>
1. Install Recharts and its peer dependency:
   ```bash
   npm install recharts react-is
   ```

2. Add chart-specific CSS variables to src/index.css under the existing :root block:
   ```css
   /* Chart-specific colors (accessible on dark background) */
   --color-chart-primary: #60a5fa;     /* Blue - bars, scatter points */
   --color-chart-secondary: #34d399;   /* Green - secondary series */
   --color-chart-accent: #f472b6;      /* Pink - highlights */
   --color-chart-grid: #3f3f3f;        /* Match existing border */
   --color-chart-reference: #fbbf24;   /* Yellow - average line */
   ```

Note: These colors have been verified for WCAG 3:1 contrast against #0f0f0f background per 08-RESEARCH.md.
  </action>
  <verify>
- `npm ls recharts` shows recharts@3.x installed
- `npm ls react-is` shows react-is installed
- `grep "color-chart-primary" src/index.css` returns the CSS variable
  </verify>
  <done>Recharts 3.x installed, 5 chart CSS variables added to index.css</done>
</task>

<task type="auto">
  <name>Task 2: Create chartUtils.ts with data transformation functions</name>
  <files>src/lib/chartUtils.ts</files>
  <action>
Create src/lib/chartUtils.ts with two data transformation functions:

1. **transformToFrequencyData(videos: Video[]): FrequencyData[]**
   - Input: Array of Video objects
   - Output: Array of 7 objects (one per day) with { day: string, dayIndex: number, count: number }
   - Use `getUTCDay()` on video.published_at to get day index (0=Sun, 6=Sat)
   - Initialize all 7 days with count=0, then count videos per day
   - Return sorted by dayIndex (Sun first)
   - Export FrequencyData interface

2. **transformToScatterData(videos: Video[], channelMap: Map<string, string>): ScatterData[]**
   - Input: Videos array and map of channelId -> channelName
   - Output: Array of { duration: number (minutes), views: number, title: string, channelName: string, videoId: string }
   - Convert duration_seconds to minutes (Math.round for cleaner axis)
   - Lookup channel name from map, fallback to 'Unknown'
   - Export ScatterData interface

Constants to include:
```typescript
export const DAYS_OF_WEEK = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'] as const
```

Type imports: Import Video from './types'.
  </action>
  <verify>
- File exists: `ls src/lib/chartUtils.ts`
- TypeScript compiles: `npx tsc --noEmit src/lib/chartUtils.ts`
- Exports correct: `grep -E "export (function|interface|const)" src/lib/chartUtils.ts` shows transformToFrequencyData, transformToScatterData, FrequencyData, ScatterData, DAYS_OF_WEEK
  </verify>
  <done>chartUtils.ts exports transformToFrequencyData, transformToScatterData, FrequencyData, ScatterData, DAYS_OF_WEEK</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds (no TypeScript errors)
2. Recharts importable: Add temp import in any file and build passes
3. CSS variables visible in browser dev tools on :root
</verification>

<success_criteria>
- Recharts 3.x installed as dependency
- 5 chart CSS variables added to index.css
- chartUtils.ts exports 2 functions, 2 interfaces, 1 constant
- All TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/08-charts/08-01-SUMMARY.md`
</output>

---
phase: 02-video-retrieval
plan: 06
type: execute
wave: 4
depends_on: ["02-02", "02-05"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Clicking channel shows its videos"
    - "Only videos >= 3 minutes displayed"
    - "Video metadata displays correctly"
    - "Click opens YouTube in new tab"
    - "Refresh button updates videos"
  artifacts: []
  key_links: []
---

<objective>
Verify Phase 2 success criteria are met end-to-end.

Purpose: Human verification ensures the complete video retrieval flow works as expected. This is a blocking checkpoint before marking Phase 2 complete.

Output: Confirmation that all REQ-VID requirements are satisfied.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-video-retrieval/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Deploy Edge Function and set secrets</name>
  <files></files>
  <action>
Deploy the Edge Function and configure the YouTube API key:

1. **Get YouTube API Key** (if not already done):
   - Go to https://console.cloud.google.com/
   - Create or select a project
   - Enable YouTube Data API v3 (APIs & Services -> Library)
   - Create API key (APIs & Services -> Credentials)

2. **Set Supabase secret**:
   ```bash
   cd "/Users/thihaaung/Library/Mobile Documents/com~apple~CloudDocs/YoutubeTracker"
   supabase secrets set YOUTUBE_API_KEY=your_api_key_here
   ```

3. **Deploy Edge Function**:
   ```bash
   supabase functions deploy fetch-channel-videos
   ```

4. **Apply database migration** (if not already):
   - Run migration in Supabase Dashboard SQL Editor
   - Or use: `supabase db push`
  </action>
  <verify>
Check function deployment:
```bash
supabase functions list
```
Should show fetch-channel-videos.
  </verify>
  <done>Edge Function deployed with YOUTUBE_API_KEY secret configured.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete video retrieval system:
- Videos database table
- Edge Function for YouTube API integration
- useChannelVideos hook
- VideoCard and VideoGrid components
- ChannelDetailPage with refresh functionality
- Navigation from channel cards to detail page
  </what-built>
  <how-to-verify>
1. Start dev server: `npm run dev`
2. Open http://localhost:5173
3. **Test channel navigation:**
   - Click on any existing channel card
   - Should navigate to /channels/[id]
   - Should see channel header with name and thumbnail
   - Should see loading skeletons while fetching videos

4. **Test video display:**
   - Videos should load and display in responsive grid
   - Each video should show:
     - Thumbnail (16:9 aspect ratio)
     - Duration badge (e.g., "15:33")
     - Title (max 2 lines)
     - View count (e.g., "1.2M views")
     - Relative date (e.g., "2 days ago")

5. **Test Shorts filtering:**
   - All displayed videos should be >= 3 minutes
   - No Shorts (< 3 min) should appear
   - (Verify by checking duration badges)

6. **Test YouTube link:**
   - Click on any video thumbnail
   - Should open youtube.com/watch?v=[id] in new tab

7. **Test refresh:**
   - Click "Refresh" button
   - Should show loading spinner
   - Should update "Last updated" timestamp
   - Toast notification should appear

8. **Test cache status:**
   - After first load, should show "From cache" if within 24hrs
   - After refresh, should show "Fresh"

9. **Test Save Idea button:**
   - Hover over video card
   - "Save Idea" bookmark button should appear
   - Click should show "Coming in Phase 3" toast

10. **Test back navigation:**
    - Click "Back to Channels" link
    - Should return to channels list
  </how-to-verify>
  <resume-signal>
Type "approved" if all checks pass.
If issues found, describe what's not working.
  </resume-signal>
</task>

</tasks>

<verification>
Phase 2 success criteria (from ROADMAP.md):
- [ ] Clicking channel shows its videos
- [ ] Only videos >= 3 minutes displayed
- [ ] Video metadata (thumbnail, duration, views, date) displays correctly
- [ ] Click opens YouTube in new tab
- [ ] Refresh button updates videos
</verification>

<success_criteria>
Human confirms all Phase 2 requirements are working:
- REQ-VID-001: Fetch latest 50 videos (up to 20 displayed after filtering)
- REQ-VID-002: Shorts filtered out (< 180 seconds)
- REQ-VID-003: Top 20 long-form videos, newest first
- REQ-VID-004: All metadata displayed correctly
- REQ-VID-005: YouTube link works
- REQ-VID-006: Refresh button with timestamp
- REQ-VID-007: Cache working (24hr TTL)
- REQ-VID-008: Save Idea button present (Phase 3 integration)
</success_criteria>

<output>
After completion, create `.planning/phases/02-video-retrieval/02-06-SUMMARY.md`
</output>

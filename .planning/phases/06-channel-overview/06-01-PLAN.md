---
phase: 06-channel-overview
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/skeletons/ChannelOverviewCardSkeleton.tsx
  - src/components/ChannelOverviewCard.tsx
  - src/components/ChannelOverviewGrid.tsx
  - src/pages/AnalyticsPage.tsx
autonomous: true

must_haves:
  truths:
    - "User sees all tracked channels as cards in a responsive grid layout"
    - "Each channel card displays subscriber count, total video count, and latest upload date"
    - "Grid adapts from 1 column on mobile to 2 on tablet to 3+ on desktop"
    - "Channel cards load with skeleton state and transition smoothly to content"
  artifacts:
    - path: "src/components/ChannelOverviewCard.tsx"
      provides: "Channel card with aggregated metrics"
      min_lines: 40
      contains: "formatViewCount"
    - path: "src/components/ChannelOverviewCardSkeleton.tsx"
      provides: "Skeleton matching card dimensions"
      min_lines: 15
      contains: "motion-safe:animate-pulse"
    - path: "src/components/ChannelOverviewGrid.tsx"
      provides: "Responsive grid container"
      min_lines: 20
      contains: "grid-cols-1"
    - path: "src/pages/AnalyticsPage.tsx"
      provides: "Integration of channel overview grid"
      contains: "ChannelOverviewGrid"
  key_links:
    - from: "src/pages/AnalyticsPage.tsx"
      to: "supabase.from('videos')"
      via: "batch query for all channel videos"
      pattern: "from\\(['\"]videos['\"]\\)"
    - from: "src/components/ChannelOverviewCard.tsx"
      to: "src/lib/formatters.ts"
      via: "formatViewCount import"
      pattern: "import.*formatViewCount"
    - from: "src/components/ChannelOverviewGrid.tsx"
      to: "src/components/ChannelOverviewCard.tsx"
      via: "renders cards in grid"
      pattern: "ChannelOverviewCard"
---

<objective>
Create channel overview cards that display each tracked channel with aggregated metrics (subscriber count, video count, latest upload) in a responsive grid layout.

Purpose: Enable users to see all tracked channels at a glance with key performance indicators, fulfilling CHAN-01 through CHAN-05 requirements.

Output: ChannelOverviewCard, ChannelOverviewCardSkeleton, ChannelOverviewGrid components, and updated AnalyticsPage showing channel overview grid.
</objective>

<execution_context>
@/Users/thihaaung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thihaaung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-channel-overview/06-RESEARCH.md

# Reference patterns
@src/components/ChannelCard.tsx
@src/components/skeletons/ChannelCardSkeleton.tsx
@src/lib/formatters.ts
@src/pages/AnalyticsPage.tsx
@src/hooks/useChannels.ts
@src/lib/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ChannelOverviewCardSkeleton component</name>
  <files>src/components/skeletons/ChannelOverviewCardSkeleton.tsx</files>
  <action>
Create skeleton component matching the channel overview card dimensions:
- Card: bg-[#272727] rounded-xl p-4
- Avatar: w-[64px] h-[64px] rounded-full (smaller than ChannelCard's 88px for compact overview)
- Channel name placeholder: h-5 w-3/4
- Three metric placeholders (subscriber count, video count, latest upload): h-4 w-1/2 each, stacked vertically with space-y-2
- Use motion-safe:animate-pulse for accessibility
- Match exact spacing to prevent CLS when content loads

Follow existing pattern from ChannelCardSkeleton.tsx.
  </action>
  <verify>
File exists at src/components/skeletons/ChannelOverviewCardSkeleton.tsx with:
- Default export function ChannelOverviewCardSkeleton
- bg-[#272727] card styling
- motion-safe:animate-pulse on animated elements
- TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
Skeleton component matches target card dimensions with proper animation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ChannelOverviewCard component</name>
  <files>src/components/ChannelOverviewCard.tsx</files>
  <action>
Create card component displaying channel with aggregated metrics:

Props interface:
```typescript
interface ChannelOverviewCardProps {
  channel: Channel
  videoCount: number
  latestUploadDate: string | null  // ISO string or null if no videos
}
```

Layout:
- Card: bg-[#272727] rounded-xl p-4, no hover state (display-only, not clickable)
- Left: Channel thumbnail w-[64px] h-[64px] rounded-full (fallback: first letter initial)
- Right: Channel name (font-semibold truncate), then 3 metric lines:
  - Subscribers: use formatViewCount(channel.subscriber_count ?? 0) + " subscribers"
  - Videos: "{videoCount} videos" (simple number, no formatting needed for <1000)
  - Latest upload: use formatRelativeDate(latestUploadDate) or "No uploads yet" if null

Import formatViewCount and formatRelativeDate from '../lib/formatters'.

Match dark theme colors: text-white for name, text-[#aaaaaa] for metrics.
  </action>
  <verify>
File exists at src/components/ChannelOverviewCard.tsx with:
- Named export ChannelOverviewCard
- Props include channel, videoCount, latestUploadDate
- Imports formatViewCount, formatRelativeDate from formatters
- TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
Card component displays channel thumbnail, name, subscriber count, video count, and latest upload date.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create ChannelOverviewGrid and integrate into AnalyticsPage</name>
  <files>src/components/ChannelOverviewGrid.tsx, src/pages/AnalyticsPage.tsx</files>
  <action>
**Part A: Create ChannelOverviewGrid component**

Props interface:
```typescript
interface ChannelOverviewGridProps {
  channels: Channel[]
  videosByChannel: Map<string, Video[]>  // channelId -> videos array
  isLoading: boolean
}
```

Implementation:
- If isLoading: render 6 ChannelOverviewCardSkeleton components in grid
- Otherwise: map over channels, for each channel:
  - Get videos from videosByChannel.get(channel.id) or []
  - Calculate videoCount = videos.length
  - Calculate latestUploadDate = videos.length > 0 ? videos[0].published_at : null (videos already sorted by published_at desc from API)
  - Render ChannelOverviewCard with these props

Grid classes (Tailwind mobile-first):
- grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4

**Part B: Update AnalyticsPage**

Replace the placeholder content in AnalyticsPage with channel overview grid:

1. Add import: `import { supabase } from '../lib/supabase'`
2. Add import: `import { ChannelOverviewGrid } from '../components/ChannelOverviewGrid'`
3. Add import: `import type { Video } from '../lib/types'`
4. Add state for videos: `const [videos, setVideos] = useState<Video[]>([])`
5. Add state for videos loading: `const [videosLoading, setVideosLoading] = useState(true)`
6. Add useEffect to fetch all videos when channels load:
```typescript
useEffect(() => {
  async function fetchAllVideos() {
    if (channels.length === 0) {
      setVideosLoading(false)
      return
    }
    const channelIds = channels.map(c => c.id)
    const { data } = await supabase
      .from('videos')
      .select('*')
      .in('channel_id', channelIds)
      .order('published_at', { ascending: false })
    setVideos(data || [])
    setVideosLoading(false)
  }
  if (!isLoading) {
    fetchAllVideos()
  }
}, [channels, isLoading])
```

7. Create videosByChannel Map:
```typescript
const videosByChannel = new Map<string, Video[]>()
for (const video of videos) {
  const arr = videosByChannel.get(video.channel_id) || []
  arr.push(video)
  videosByChannel.set(video.channel_id, arr)
}
```

8. Replace placeholder content state with:
```tsx
<div className="max-w-7xl mx-auto p-4">
  <h1 className="text-2xl font-bold mb-6">Analytics</h1>
  <section className="mb-8">
    <h2 className="text-lg font-semibold mb-4 text-[#aaaaaa]">Channel Overview</h2>
    <ChannelOverviewGrid
      channels={channels}
      videosByChannel={videosByChannel}
      isLoading={videosLoading}
    />
  </section>
</div>
```

Note: Keep existing loading, error, and empty states as-is. Only modify the content state (where channels.length > 0).
  </action>
  <verify>
1. ChannelOverviewGrid.tsx exists with named export
2. AnalyticsPage.tsx imports and uses ChannelOverviewGrid
3. TypeScript compiles: `npx tsc --noEmit`
4. Dev server runs without errors: `npm run dev` (quick check)
5. Navigate to /analytics with tracked channels - grid should display channel cards with metrics
  </verify>
  <done>
- ChannelOverviewGrid renders responsive grid of channel cards
- AnalyticsPage fetches videos and displays channel overview
- Skeleton shows during loading, cards show with real data when loaded
- Grid is responsive: 1 col mobile, 2 tablet, 3 desktop
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Build check**: `npm run build` passes without errors
2. **Type check**: `npx tsc --noEmit` passes
3. **Visual verification**:
   - Navigate to /analytics with tracked channels
   - Verify skeleton appears briefly during load
   - Verify each channel card shows: thumbnail, name, subscriber count, video count, latest upload
   - Resize browser to verify responsive breakpoints (1/2/3 columns)
4. **Empty state preserved**: Navigate with no channels, empty state still works
</verification>

<success_criteria>
Requirements fulfilled:
- [x] CHAN-01: User can view all tracked channels as overview cards
- [x] CHAN-02: Each channel card displays subscriber count
- [x] CHAN-03: Each channel card displays total video count (from fetched videos)
- [x] CHAN-04: Each channel card displays latest upload date
- [x] CHAN-05: Channel cards are responsive (grid layout: 1 col mobile, 2 tablet, 3+ desktop)

Phase success criteria met:
- [x] User sees all tracked channels as cards in a responsive grid layout
- [x] Each channel card displays subscriber count, total video count, and latest upload date
- [x] Grid adapts from 1 column on mobile to 2 on tablet to 3+ on desktop
- [x] Channel cards load with skeleton state and transition smoothly to content
</success_criteria>

<output>
After completion, create `.planning/phases/06-channel-overview/06-01-SUMMARY.md` following the summary template.

Document:
- Files created/modified
- Any pattern decisions (e.g., video data fetching approach)
- Deviations from plan (if any)
- Ready state for Phase 7
</output>
